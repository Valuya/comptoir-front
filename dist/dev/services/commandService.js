var CommandItem = (function () {
    function CommandItem(item) {
        this.item = item;
        this.amount = 0;
        this.reduction = null;
        this.price = 0;
    }
    return CommandItem;
})();
exports.CommandItem = CommandItem;
var CommandService = (function () {
    function CommandService() {
        this.items = [];
        this.totalPrice = 0;
    }
    CommandService.prototype.addItem = function (item) {
        var id = item.id;
        var commandItem = null;
        if (this.items[id] != undefined) {
            commandItem = this.items[id];
        }
        else {
            commandItem = new CommandItem(item);
        }
        commandItem.amount++;
        this.calcItemPrice(commandItem);
        this.calcTotalPrice();
    };
    CommandService.prototype.removeItem = function (item) {
        var id = item.id;
        this.items[id] = undefined;
        this.calcTotalPrice();
    };
    CommandService.prototype.setReduction = function (item, reduction) {
        var id = item.id;
        if (this.items[id] == undefined) {
            return;
        }
        var commandItem = this.items[id];
        commandItem.reduction = reduction;
        this.calcItemPrice(commandItem);
        this.calcTotalPrice();
    };
    CommandService.prototype.calcTotalPrice = function () {
        this.totalPrice = 0;
        this.items.forEach(function (item) {
            var price = item.price;
            this.totalPrice += price;
        });
    };
    CommandService.prototype.calcItemPrice = function (commandItem) {
        var item = commandItem.item;
        if (item == null) {
            return;
        }
        var itemPrice = item.currentPrice;
        var amount = commandItem.amount;
        var totalPrice = amount * itemPrice;
        var reduction = commandItem.reduction;
        if (reduction != null) {
            var reductionAmount = reduction * totalPrice;
            totalPrice -= reduction;
        }
        commandItem.price = totalPrice;
    };
    return CommandService;
})();
exports.CommandService = CommandService;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL2NvbW1hbmRTZXJ2aWNlLnRzIl0sIm5hbWVzIjpbIkNvbW1hbmRJdGVtIiwiQ29tbWFuZEl0ZW0uY29uc3RydWN0b3IiLCJDb21tYW5kU2VydmljZSIsIkNvbW1hbmRTZXJ2aWNlLmNvbnN0cnVjdG9yIiwiQ29tbWFuZFNlcnZpY2UuYWRkSXRlbSIsIkNvbW1hbmRTZXJ2aWNlLnJlbW92ZUl0ZW0iLCJDb21tYW5kU2VydmljZS5zZXRSZWR1Y3Rpb24iLCJDb21tYW5kU2VydmljZS5jYWxjVG90YWxQcmljZSIsIkNvbW1hbmRTZXJ2aWNlLmNhbGNJdGVtUHJpY2UiXSwibWFwcGluZ3MiOiJBQUtBO0lBTUlBLHFCQUFZQSxJQUFVQTtRQUNsQkMsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDakJBLElBQUlBLENBQUNBLE1BQU1BLEdBQUVBLENBQUNBLENBQUNBO1FBQ2ZBLElBQUlBLENBQUNBLFNBQVNBLEdBQUdBLElBQUlBLENBQUNBO1FBQ3RCQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxDQUFDQSxDQUFDQTtJQUNuQkEsQ0FBQ0E7SUFDTEQsa0JBQUNBO0FBQURBLENBWkEsQUFZQ0EsSUFBQTtBQVpZLG1CQUFXLGNBWXZCLENBQUE7QUFFRDtJQUlJRTtRQUNJQyxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxFQUFFQSxDQUFDQTtRQUNoQkEsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7SUFDeEJBLENBQUNBO0lBRURELGdDQUFPQSxHQUFQQSxVQUFRQSxJQUFVQTtRQUNkRSxJQUFJQSxFQUFFQSxHQUFHQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQTtRQUNqQkEsSUFBSUEsV0FBV0EsR0FBZ0JBLElBQUlBLENBQUNBO1FBQ3BDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxFQUFFQSxDQUFDQSxJQUFJQSxTQUFTQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUM5QkEsV0FB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aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IGNnaGlzbGFpIG9uIDI4LzA3LzE1LlxuICovXG5pbXBvcnQge0l0ZW19IGZyb20gJ3NlcnZpY2VzL2l0ZW1TZXJ2aWNlJztcblxuZXhwb3J0IGNsYXNzIENvbW1hbmRJdGVtIHtcbiAgICBpdGVtOiBJdGVtO1xuICAgIGFtb3VudDogbnVtYmVyO1xuICAgIHJlZHVjdGlvbjogbnVtYmVyO1xuICAgIHByaWNlOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihpdGVtOiBJdGVtKSB7XG4gICAgICAgIHRoaXMuaXRlbSA9IGl0ZW07XG4gICAgICAgIHRoaXMuYW1vdW50ID0wO1xuICAgICAgICB0aGlzLnJlZHVjdGlvbiA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpY2UgPSAwO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbW1hbmRTZXJ2aWNlIHtcbiAgICBpdGVtczogQ29tbWFuZEl0ZW1bXTtcbiAgICB0b3RhbFByaWNlOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLnRvdGFsUHJpY2UgPSAwO1xuICAgIH1cblxuICAgIGFkZEl0ZW0oaXRlbTogSXRlbSkge1xuICAgICAgICB2YXIgaWQgPSBpdGVtLmlkO1xuICAgICAgICB2YXIgY29tbWFuZEl0ZW06IENvbW1hbmRJdGVtID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuaXRlbXNbaWRdICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29tbWFuZEl0ZW0gPSB0aGlzLml0ZW1zW2lkXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbW1hbmRJdGVtID0gbmV3IENvbW1hbmRJdGVtKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbW1hbmRJdGVtLmFtb3VudCsrO1xuICAgICAgICB0aGlzLmNhbGNJdGVtUHJpY2UoY29tbWFuZEl0ZW0pO1xuICAgICAgICB0aGlzLmNhbGNUb3RhbFByaWNlKCk7XG4gICAgfVxuICAgIHJlbW92ZUl0ZW0oaXRlbTogSXRlbSkge1xuICAgICAgICB2YXIgaWQgPSBpdGVtLmlkO1xuICAgICAgICB0aGlzLml0ZW1zW2lkXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jYWxjVG90YWxQcmljZSgpO1xuICAgIH1cbiAgICBzZXRSZWR1Y3Rpb24oaXRlbTogSXRlbSwgcmVkdWN0aW9uOiBudW1iZXIpIHtcbiAgICAgICAgdmFyIGlkID0gaXRlbS5pZDtcbiAgICAgICAgaWYgKHRoaXMuaXRlbXNbaWRdID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb21tYW5kSXRlbSA9IHRoaXMuaXRlbXNbaWRdO1xuICAgICAgICBjb21tYW5kSXRlbS5yZWR1Y3Rpb24gPSByZWR1Y3Rpb247XG4gICAgICAgIHRoaXMuY2FsY0l0ZW1QcmljZShjb21tYW5kSXRlbSk7XG4gICAgICAgIHRoaXMuY2FsY1RvdGFsUHJpY2UoKTtcbiAgICB9XG4gICAgY2FsY1RvdGFsUHJpY2UoKSB7XG4gICAgICAgIHRoaXMudG90YWxQcmljZSA9IDA7XG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChmdW5jdGlvbihpdGVtOiBDb21tYW5kSXRlbSkge1xuICAgICAgICAgICAgdmFyIHByaWNlID0gaXRlbS5wcmljZTtcbiAgICAgICAgICAgIHRoaXMudG90YWxQcmljZSArPSBwcmljZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNhbGNJdGVtUHJpY2UoY29tbWFuZEl0ZW06IENvbW1hbmRJdGVtKSB7XG4gICAgICAgIHZhciBpdGVtID0gY29tbWFuZEl0ZW0uaXRlbTtcbiAgICAgICAgaWYgKGl0ZW0gPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpdGVtUHJpY2UgPSBpdGVtLmN1cnJlbnRQcmljZTtcbiAgICAgICAgdmFyIGFtb3VudCA9IGNvbW1hbmRJdGVtLmFtb3VudDtcbiAgICAgICAgdmFyIHRvdGFsUHJpY2UgPSBhbW91bnQgKiBpdGVtUHJpY2UgO1xuXG4gICAgICAgIHZhciByZWR1Y3Rpb24gPSBjb21tYW5kSXRlbS5yZWR1Y3Rpb247XG4gICAgICAgIGlmIChyZWR1Y3Rpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHJlZHVjdGlvbkFtb3VudCA9IHJlZHVjdGlvbiAqIHRvdGFsUHJpY2U7XG4gICAgICAgICAgICB0b3RhbFByaWNlIC09IHJlZHVjdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBjb21tYW5kSXRlbS5wcmljZSA9IHRvdGFsUHJpY2U7XG4gICAgfVxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
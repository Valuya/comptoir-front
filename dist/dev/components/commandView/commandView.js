var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") return Reflect.decorate(decorators, target, key, desc);
    switch (arguments.length) {
        case 2: return decorators.reduceRight(function(o, d) { return (d && d(o)) || o; }, target);
        case 3: return decorators.reduceRight(function(o, d) { return (d && d(target, key)), void 0; }, void 0);
        case 4: return decorators.reduceRight(function(o, d) { return (d && d(target, key, o)) || o; }, desc);
    }
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
/// <reference path="../../typings/_custom.d.ts" />
var angular2_1 = require('angular2/angular2');
var commandService_1 = require('services/commandService');
var itemService_1 = require('services/itemService');
var autoFocus_1 = require('directives/autoFocus');
var ToAddItem = (function () {
    function ToAddItem() {
        this.name = null;
        this.amount = 1;
        this.price = null;
    }
    return ToAddItem;
})();
var CommandView = (function () {
    function CommandView(commandService) {
        this.editingGlobalReduction = false;
        this.validate = new angular2_1.EventEmitter();
        this.validated = false;
        this.commandService = commandService;
        this.renewToAddCustomItem();
        this.toAddReductionItem = null;
    }
    CommandView.prototype.renewToAddCustomItem = function () {
        this.toAddItem = new ToAddItem();
    };
    CommandView.prototype.doClearCommand = function () {
        this.commandService.items = [];
        this.commandService.globalReduction = null;
        this.commandService.calcTotalPrice();
    };
    CommandView.prototype.doClearItem = function (commandItem) {
        this.commandService.removeCommandItem(commandItem);
    };
    CommandView.prototype.doAddCustomItem = function () {
        var item = new itemService_1.Item(undefined);
        item.currentPrice = this.toAddItem.price;
        item.name = this.toAddItem.name;
        item.reference = null;
        var commandItem = new commandService_1.CommandItem(item);
        commandItem.amount = this.toAddItem.amount;
        this.commandService.addCommandItem(commandItem);
        this.renewToAddCustomItem();
    };
    CommandView.prototype.doStartItemReduction = function (commandItem) {
        this.toAddReductionItem = commandItem;
    };
    CommandView.prototype.applyItemReduction = function (event) {
        if (event.which == 13) {
            var reduction = event.target.value;
            this.toAddReductionItem.reduction = reduction;
            this.commandService.calcItemPrice(this.toAddReductionItem);
            this.commandService.calcTotalPrice();
            this.toAddReductionItem = null;
            return;
        }
        if (event.which == 27) {
            this.toAddReductionItem = null;
            return;
        }
    };
    CommandView.prototype.applyGlobalReduction = function (event) {
        if (event.which == 13) {
            var reduction = event.target.value;
            this.commandService.globalReduction = reduction;
            this.commandService.calcTotalPrice();
            this.editingGlobalReduction = false;
            return;
        }
        if (event.which == 27) {
            this.editingGlobalReduction = false;
            return;
        }
    };
    CommandView.prototype.doValidate = function () {
        this.validated = true;
        this.validate.next(this.validated);
    };
    CommandView.prototype.doUnvalidate = function () {
        this.validated = false;
        this.validate.next(this.validated);
    };
    CommandView = __decorate([
        angular2_1.Component({
            selector: 'commandView',
            events: ['validate'],
            properties: ['validated']
        }),
        angular2_1.View({
            templateUrl: './components/commandView/commandView.html',
            styleUrls: ['./components/commandView/commandView.css'],
            directives: [angular2_1.NgFor, angular2_1.NgIf, autoFocus_1.AutoFocusDirective]
        }), 
        __metadata('design:paramtypes', [commandService_1.CommandService])
    ], CommandView);
    return CommandView;
})();
exports.CommandView = CommandView;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvY29tbWFuZFZpZXcvY29tbWFuZFZpZXcudHMiXSwibmFtZXMiOlsiVG9BZGRJdGVtIiwiVG9BZGRJdGVtLmNvbnN0cnVjdG9yIiwiQ29tbWFuZFZpZXciLCJDb21tYW5kVmlldy5jb25zdHJ1Y3RvciIsIkNvbW1hbmRWaWV3LnJlbmV3VG9BZGRDdXN0b21JdGVtIiwiQ29tbWFuZFZpZXcuZG9DbGVhckNvbW1hbmQiLCJDb21tYW5kVmlldy5kb0NsZWFySXRlbSIsIkNvbW1hbmRWaWV3LmRvQWRkQ3VzdG9tSXRlbSIsIkNvbW1hbmRWaWV3LmRvU3RhcnRJdGVtUmVkdWN0aW9uIiwiQ29tbWFuZFZpZXcuYXBwbHlJdGVtUmVkdWN0aW9uIiwiQ29tbWFuZFZpZXcuYXBwbHlHbG9iYWxSZWR1Y3Rpb24iLCJDb21tYW5kVmlldy5kb1ZhbGlkYXRlIiwiQ29tbWFuZFZpZXcuZG9VbnZhbGlkYXRlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUdBLEFBQ0EsbURBRG1EO0FBQ25ELHlCQUF5RCxtQkFBbUIsQ0FBQyxDQUFBO0FBQzdFLCtCQUEwQyx5QkFBeUIsQ0FBQyxDQUFBO0FBQ3BFLDRCQUFtQixzQkFBc0IsQ0FBQyxDQUFBO0FBQzFDLDBCQUFpQyxzQkFBc0IsQ0FBQyxDQUFBO0FBR3hEO0lBQUFBO1FBQ0lDLFNBQUlBLEdBQVdBLElBQUlBLENBQUNBO1FBQ3BCQSxXQUFNQSxHQUFXQSxDQUFDQSxDQUFDQTtRQUNuQkEsVUFBS0EsR0FBV0EsSUFBSUEsQ0FBQ0E7SUFDekJBLENBQUNBO0lBQURELGdCQUFDQTtBQUFEQSxDQUpBLEFBSUNBLElBQUE7QUFLRDtJQXFCSUUscUJBQVlBLGNBQThCQTtRQUoxQ0MsMkJBQXNCQSxHQUFZQSxLQUFLQSxDQUFDQTtRQUN4Q0EsYUFBUUEsR0FBR0EsSUFBSUEsdUJBQVlBLEVBQUVBLENBQUNBO1FBQzlCQSxjQUFTQSxHQUFZQSxLQUFLQSxDQUFDQTtRQUd2QkEsSUFBSUEsQ0FBQ0EsY0FBY0EsR0FB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dkRBLFVBQVVBLEVBQUVBLENBQUNBLGdCQUFLQSxFQUFFQSxlQUFJQSxFQUFFQSw4QkFBa0JBLENBQUNBO1NBQ2hEQSxDQUFDQTs7b0JBK0VEQTtJQUFEQSxrQkFBQ0E7QUFBREEsQ0F6RkEsQUF5RkNBLElBQUE7QUE3RVksbUJBQVcsY0E2RXZCLENBQUEiLCJmaWxlIjoiY29tcG9uZW50cy9jb21tYW5kVmlldy9jb21tYW5kVmlldy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSBjZ2hpc2xhaSBvbiAyOS8wNy8xNS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL3R5cGluZ3MvX2N1c3RvbS5kLnRzXCIgLz5cbmltcG9ydCB7Q29tcG9uZW50LCBWaWV3LCBOZ0ZvciwgTmdJZiwgRXZlbnRFbWl0dGVyfSBmcm9tICdhbmd1bGFyMi9hbmd1bGFyMic7XG5pbXBvcnQge0NvbW1hbmRTZXJ2aWNlLCBDb21tYW5kSXRlbX0gZnJvbSAnc2VydmljZXMvY29tbWFuZFNlcnZpY2UnO1xuaW1wb3J0IHtJdGVtfSBmcm9tICdzZXJ2aWNlcy9pdGVtU2VydmljZSc7XG5pbXBvcnQge0F1dG9Gb2N1c0RpcmVjdGl2ZX0gZnJvbSAnZGlyZWN0aXZlcy9hdXRvRm9jdXMnO1xuXG4vLyBUT0RPOiB1c2UgYW5ndWxhcjIgZm9ybSBtb2RlbCAmIHZhbGlkYXRvcnNcbmNsYXNzIFRvQWRkSXRlbSB7XG4gICAgbmFtZTogc3RyaW5nID0gbnVsbDtcbiAgICBhbW91bnQ6IG51bWJlciA9IDE7XG4gICAgcHJpY2U6IG51bWJlciA9IG51bGw7XG59XG5cblxuXG4vLyBUaGUgY29tcG9uZW50XG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2NvbW1hbmRWaWV3JyxcbiAgICBldmVudHM6IFsndmFsaWRhdGUnXSxcbiAgICBwcm9wZXJ0aWVzOiBbJ3ZhbGlkYXRlZCddXG59KVxuXG5AVmlldyh7XG4gICAgdGVtcGxhdGVVcmw6ICcuL2NvbXBvbmVudHMvY29tbWFuZFZpZXcvY29tbWFuZFZpZXcuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vY29tcG9uZW50cy9jb21tYW5kVmlldy9jb21tYW5kVmlldy5jc3MnXSxcbiAgICBkaXJlY3RpdmVzOiBbTmdGb3IsIE5nSWYsIEF1dG9Gb2N1c0RpcmVjdGl2ZV1cbn0pXG5cbmV4cG9ydCBjbGFzcyBDb21tYW5kVmlldyB7XG5cbiAgICBjb21tYW5kU2VydmljZTogQ29tbWFuZFNlcnZpY2U7XG4gICAgdG9BZGRJdGVtOiBUb0FkZEl0ZW07XG4gICAgdG9BZGRSZWR1Y3Rpb25JdGVtOiBDb21tYW5kSXRlbTtcbiAgICBlZGl0aW5nR2xvYmFsUmVkdWN0aW9uOiBib29sZWFuID0gZmFsc2U7XG4gICAgdmFsaWRhdGUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgdmFsaWRhdGVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3Rvcihjb21tYW5kU2VydmljZTogQ29tbWFuZFNlcnZpY2UpIHtcbiAgICAgICAgdGhpcy5jb21tYW5kU2VydmljZSA9IGNvbW1hbmRTZXJ2aWNlO1xuICAgICAgICB0aGlzLnJlbmV3VG9BZGRDdXN0b21JdGVtKCk7XG4gICAgICAgIHRoaXMudG9BZGRSZWR1Y3Rpb25JdGVtID0gbnVsbDtcbiAgICB9XG5cbiAgICByZW5ld1RvQWRkQ3VzdG9tSXRlbSgpIHtcbiAgICAgICAgdGhpcy50b0FkZEl0ZW0gPSBuZXcgVG9BZGRJdGVtKCk7XG4gICAgfVxuXG4gICAgZG9DbGVhckNvbW1hbmQoKSB7XG4gICAgICAgIHRoaXMuY29tbWFuZFNlcnZpY2UuaXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy5jb21tYW5kU2VydmljZS5nbG9iYWxSZWR1Y3Rpb24gPSBudWxsO1xuICAgICAgICB0aGlzLmNvbW1hbmRTZXJ2aWNlLmNhbGNUb3RhbFByaWNlKCk7XG4gICAgfVxuICAgIGRvQ2xlYXJJdGVtKGNvbW1hbmRJdGVtOiBDb21tYW5kSXRlbSkge1xuICAgICAgICB0aGlzLmNvbW1hbmRTZXJ2aWNlLnJlbW92ZUNvbW1hbmRJdGVtKGNvbW1hbmRJdGVtKTtcbiAgICB9XG5cbiAgICBkb0FkZEN1c3RvbUl0ZW0oKSB7XG4gICAgICAgIHZhciBpdGVtID0gbmV3IEl0ZW0odW5kZWZpbmVkKTtcbiAgICAgICAgaXRlbS5jdXJyZW50UHJpY2UgPSB0aGlzLnRvQWRkSXRlbS5wcmljZTtcbiAgICAgICAgaXRlbS5uYW1lICA9IHRoaXMudG9BZGRJdGVtLm5hbWU7XG4gICAgICAgIGl0ZW0ucmVmZXJlbmNlID0gbnVsbDtcbiAgICAgICAgdmFyIGNvbW1hbmRJdGVtID0gbmV3IENvbW1hbmRJdGVtKGl0ZW0pO1xuICAgICAgICBjb21tYW5kSXRlbS5hbW91bnQgPSB0aGlzLnRvQWRkSXRlbS5hbW91bnQ7XG4gICAgICAgIHRoaXMuY29tbWFuZFNlcnZpY2UuYWRkQ29tbWFuZEl0ZW0oY29tbWFuZEl0ZW0pO1xuICAgICAgICB0aGlzLnJlbmV3VG9BZGRDdXN0b21JdGVtKCk7XG4gICAgfVxuICAgIGRvU3RhcnRJdGVtUmVkdWN0aW9uKGNvbW1hbmRJdGVtOiBDb21tYW5kSXRlbSkge1xuICAgICAgICB0aGlzLnRvQWRkUmVkdWN0aW9uSXRlbSA9IGNvbW1hbmRJdGVtO1xuICAgIH1cbiAgICBhcHBseUl0ZW1SZWR1Y3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LndoaWNoID09IDEzKSB7IC8vIEVudGVyXG4gICAgICAgICAgICB2YXIgcmVkdWN0aW9uOiBudW1iZXIgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICB0aGlzLnRvQWRkUmVkdWN0aW9uSXRlbS5yZWR1Y3Rpb24gPSByZWR1Y3Rpb247XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRTZXJ2aWNlLmNhbGNJdGVtUHJpY2UodGhpcy50b0FkZFJlZHVjdGlvbkl0ZW0pO1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kU2VydmljZS5jYWxjVG90YWxQcmljZSgpO1xuICAgICAgICAgICAgdGhpcy50b0FkZFJlZHVjdGlvbkl0ZW0gPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudC53aGljaCA9PSAyNykgeyAvLyBFc2NhcGVcbiAgICAgICAgICAgIHRoaXMudG9BZGRSZWR1Y3Rpb25JdGVtID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhcHBseUdsb2JhbFJlZHVjdGlvbihldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT0gMTMpIHsgLy8gRW50ZXJcbiAgICAgICAgICAgIHZhciByZWR1Y3Rpb246IG51bWJlciA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZFNlcnZpY2UuZ2xvYmFsUmVkdWN0aW9uID0gcmVkdWN0aW9uO1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kU2VydmljZS5jYWxjVG90YWxQcmljZSgpO1xuICAgICAgICAgICAgdGhpcy5lZGl0aW5nR2xvYmFsUmVkdWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50LndoaWNoID09IDI3KSB7IC8vIEVzY2FwZVxuICAgICAgICAgICAgdGhpcy5lZGl0aW5nR2xvYmFsUmVkdWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgZG9WYWxpZGF0ZSgpIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnZhbGlkYXRlLm5leHQodGhpcy52YWxpZGF0ZWQpO1xuICAgIH1cbiAgICBkb1VudmFsaWRhdGUoKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMudmFsaWRhdGUubmV4dCh0aGlzLnZhbGlkYXRlZCk7XG4gICAgfVxuXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9